#+hledger-lots avg_cost:false, check:true
#+hledger-lots no_desc:

#+args buy_aapl:bal desc:"Buy AAPL"
#+args aapl_cur:bal desc:"Buy AAPL" cur:{commodity}
#+args sell_aapl: bal desc:"Sold" {tag_price}

commodity 1,000.00   USD
commodity 1,000.0000 AAPL        ; yahoo_ticker:AAPL
commodity 1,000.0000 GOOG        ; yahoo_ticker:GOOG
commodity 1,000.0000 "PETR4.SA"  ; yahoo_ticker:PETR4.SA

2023-01-01 Initial
    Asset:Bank                             100000.00 USD
    Equity:Initial

2023-01-05 Buy AAPL
    Asset:Stocks                                  5 AAPL @ 160 USD
    Asset:Bank

2023-01-10 Buy AAPL
    Asset:Stocks                                  10 AAPL @ 145 USD
    Asset:Bank

2023-01-15 Sold Y.AAPL  ; cost_method:fifo
    ; commodity:Y.AAPL, qtty:3.00, price:163.00
    ; avg_cost:160.0000, xirr:0.95% annual percent rate 30/360US
    Asset:Bank                           489.00 USD
    Asset:Stocks            -3.0 AAPL @ 160 USD  ; buy_date:2023-01-05, base_cur:USD
    Revenue:Capital Gain                  -9.00 USD


2023-01-20 Buy AAPL
    Asset:Stocks                                  15 AAPL @ 168 USD
    Asset:Bank

2023-01-25 Sold AAPL  ; cost_method:fifo
    ; commodity:AAPL, qtty:8.00, price:168.00
    ; avg_cost:148.7500, xirr:13.55% annual percent rate 30/360US
    Asset:Bank                      1344.00 USD
    Asset:Stocks            -2.0 AAPL @ 160 USD  ; buy_date:2023-01-05, base_cur:USD
    Asset:Stocks            -6.0 AAPL @ 145 USD  ; buy_date:2023-01-10, base_cur:USD
    Revenue:Capital Gain            -154.00 USD


2023-02-01 Buy GOOG
    Asset:Stocks                                  15 GOOG @ 102 USD
    Asset:Bank



2023-02-05 Sold GOOG  ; cost_method:fifo
    ; commodity:GOOG, qtty:12.00, price:106.00
    ; avg_cost:102.0000, xirr:30.88% annual percent rate 30/360US
    Asset:Bank                       1272.00 USD
    Asset:Stocks            -12.0 GOOG @ 102 USD  ; buy_date:2023-02-01, base_cur:USD
    Revenue:Capital Gain              -48.00 USD


P 2023-01-06 "AAPL" 129.42239379882812 USD
P 2023-01-09 "AAPL" 129.9515838623047 USD
P 2023-01-10 "AAPL" 130.53070068359375 USD
P 2023-01-11 "AAPL" 133.2864990234375 USD
P 2023-01-12 "AAPL" 133.2066192626953 USD
P 2023-01-13 "AAPL" 134.55455017089844 USD
P 2023-01-17 "AAPL" 135.73275756835938 USD
P 2023-01-18 "AAPL" 135.00387573242188 USD
P 2023-01-19 "AAPL" 135.06378173828125 USD
P 2023-01-20 "AAPL" 137.65980529785156 USD
P 2023-01-23 "AAPL" 140.89488220214844 USD
P 2023-01-24 "AAPL" 142.31271362304688 USD
P 2023-01-25 "AAPL" 141.64373779296875 USD
P 2023-01-26 "AAPL" 143.74053955078125 USD
P 2023-01-27 "AAPL" 145.70751953125 USD
P 2023-01-30 "AAPL" 142.78199768066406 USD
P 2023-01-31 "AAPL" 144.0700225830078 USD
P 2023-02-01 "AAPL" 145.20828247070312 USD
P 2023-02-02 "AAPL" 150.590087890625 USD
P 2023-02-03 "AAPL" 154.26446533203125 USD
P 2023-02-06 "AAPL" 151.49868774414062 USD
P 2023-02-07 "AAPL" 154.4142303466797 USD
P 2023-02-08 "AAPL" 151.6884002685547 USD
P 2023-02-09 "AAPL" 150.63999938964844 USD
P 2023-02-10 "AAPL" 151.00999450683594 USD
P 2023-02-13 "AAPL" 153.85000610351562 USD
P 2023-02-14 "AAPL" 153.1999969482422 USD
P 2023-02-15 "AAPL" 155.3300018310547 USD
P 2023-02-16 "AAPL" 153.7100067138672 USD
P 2023-02-17 "AAPL" 152.5500030517578 USD
P 2023-02-21 "AAPL" 148.47999572753906 USD
P 2023-02-22 "AAPL" 148.91000366210938 USD
P 2023-02-23 "AAPL" 149.39999389648438 USD
P 2023-02-24 "AAPL" 146.7100067138672 USD
P 2023-02-27 "AAPL" 147.9199981689453 USD
P 2023-02-28 "AAPL" 147.41000366210938 USD
P 2023-03-01 "AAPL" 145.30999755859375 USD
P 2023-03-02 "AAPL" 145.91000366210938 USD
P 2023-03-03 "AAPL" 151.02999877929688 USD
P 2023-03-06 "AAPL" 153.8300018310547 USD
P 2023-03-07 "AAPL" 151.60000610351562 USD
P 2023-03-08 "AAPL" 152.8699951171875 USD
P 2023-03-09 "AAPL" 150.58999633789062 USD
P 2023-03-10 "AAPL" 148.5 USD
P 2023-03-13 "AAPL" 150.47000122070312 USD
P 2023-03-14 "AAPL" 152.58999633789062 USD
P 2023-03-15 "AAPL" 152.99000549316406 USD
P 2023-03-16 "AAPL" 155.85000610351562 USD
P 2023-03-17 "AAPL" 155.0 USD
P 2023-03-20 "AAPL" 157.39999389648438 USD
P 2023-03-21 "AAPL" 159.27999877929688 USD
P 2023-03-22 "AAPL" 157.8300018310547 USD
P 2023-03-23 "AAPL" 158.92999267578125 USD
P 2023-03-24 "AAPL" 160.25 USD
P 2023-03-27 "AAPL" 158.27999877929688 USD
P 2023-03-28 "AAPL" 157.64999389648438 USD
P 2023-03-29 "AAPL" 160.77000427246094 USD
P 2023-03-30 "AAPL" 162.36000061035156 USD
P 2023-03-31 "AAPL" 164.89999389648438 USD
P 2023-04-03 "AAPL" 166.1699981689453 USD
P 2023-04-04 "AAPL" 165.6300048828125 USD
P 2023-04-05 "AAPL" 163.75999450683594 USD
P 2023-04-06 "AAPL" 164.66000366210938 USD
P 2023-04-10 "AAPL" 162.02999877929688 USD
P 2023-04-11 "AAPL" 160.8000030517578 USD
P 2023-04-12 "AAPL" 160.10000610351562 USD
P 2023-04-13 "AAPL" 165.55999755859375 USD
P 2023-04-14 "AAPL" 165.2100067138672 USD
P 2023-04-17 "AAPL" 165.22999572753906 USD
P 2023-04-18 "AAPL" 166.47000122070312 USD
P 2023-04-19 "AAPL" 167.6300048828125 USD
P 2023-04-20 "AAPL" 166.64999389648438 USD
P 2023-04-21 "AAPL" 165.02000427246094 USD
P 2023-04-24 "AAPL" 165.3300018310547 USD
P 2023-04-25 "AAPL" 163.77000427246094 USD
P 2023-04-26 "AAPL" 163.75999450683594 USD
P 2023-04-27 "AAPL" 168.41000366210938 USD
P 2023-04-28 "AAPL" 169.67999267578125 USD
P 2023-05-01 "AAPL" 169.58999633789062 USD
P 2023-05-02 "AAPL" 168.5399932861328 USD
P 2023-05-03 "AAPL" 167.4499969482422 USD


P 2023-02-02 "GOOG" 108.80000305175781 USD
P 2023-02-03 "GOOG" 105.22000122070312 USD
P 2023-02-06 "GOOG" 103.47000122070312 USD
P 2023-02-07 "GOOG" 108.04000091552734 USD
P 2023-02-08 "GOOG" 100.0 USD
P 2023-02-09 "GOOG" 95.45999908447266 USD
P 2023-02-10 "GOOG" 94.86000061035156 USD
P 2023-02-13 "GOOG" 95.0 USD
P 2023-02-14 "GOOG" 94.94999694824219 USD
P 2023-02-15 "GOOG" 97.0999984741211 USD
P 2023-02-16 "GOOG" 95.77999877929688 USD
P 2023-02-17 "GOOG" 94.58999633789062 USD
P 2023-02-21 "GOOG" 92.05000305175781 USD
P 2023-02-22 "GOOG" 91.80000305175781 USD
P 2023-02-23 "GOOG" 91.06999969482422 USD
P 2023-02-24 "GOOG" 89.3499984741211 USD
P 2023-02-27 "GOOG" 90.0999984741211 USD
P 2023-02-28 "GOOG" 90.30000305175781 USD
P 2023-03-01 "GOOG" 90.51000213623047 USD
P 2023-03-02 "GOOG" 92.30999755859375 USD
P 2023-03-03 "GOOG" 94.0199966430664 USD
P 2023-03-06 "GOOG" 95.58000183105469 USD
P 2023-03-07 "GOOG" 94.16999816894531 USD
P 2023-03-08 "GOOG" 94.6500015258789 USD
P 2023-03-09 "GOOG" 92.66000366210938 USD
P 2023-03-10 "GOOG" 91.01000213623047 USD
P 2023-03-13 "GOOG" 91.66000366210938 USD
P 2023-03-14 "GOOG" 94.25 USD
P 2023-03-15 "GOOG" 96.55000305175781 USD
P 2023-03-16 "GOOG" 101.06999969482422 USD
P 2023-03-17 "GOOG" 102.45999908447266 USD
P 2023-03-20 "GOOG" 101.93000030517578 USD
P 2023-03-21 "GOOG" 105.83999633789062 USD
P 2023-03-22 "GOOG" 104.22000122070312 USD
P 2023-03-23 "GOOG" 106.26000213623047 USD
P 2023-03-24 "GOOG" 106.05999755859375 USD
P 2023-03-27 "GOOG" 103.05999755859375 USD
P 2023-03-28 "GOOG" 101.36000061035156 USD
P 2023-03-29 "GOOG" 101.9000015258789 USD
P 2023-03-30 "GOOG" 101.31999969482422 USD
P 2023-03-31 "GOOG" 104.0 USD
P 2023-04-03 "GOOG" 104.91000366210938 USD
P 2023-04-04 "GOOG" 105.12000274658203 USD
P 2023-04-05 "GOOG" 104.94999694824219 USD
P 2023-04-06 "GOOG" 108.9000015258789 USD
P 2023-04-10 "GOOG" 106.94999694824219 USD
P 2023-04-11 "GOOG" 106.12000274658203 USD
P 2023-04-12 "GOOG" 105.22000122070312 USD
P 2023-04-13 "GOOG" 108.19000244140625 USD
P 2023-04-14 "GOOG" 109.45999908447266 USD
P 2023-04-17 "GOOG" 106.41999816894531 USD
P 2023-04-18 "GOOG" 105.12000274658203 USD
P 2023-04-19 "GOOG" 105.0199966430664 USD
P 2023-04-20 "GOOG" 105.9000015258789 USD
P 2023-04-21 "GOOG" 105.91000366210938 USD
P 2023-04-24 "GOOG" 106.77999877929688 USD
P 2023-04-25 "GOOG" 104.61000061035156 USD
P 2023-04-26 "GOOG" 104.44999694824219 USD
P 2023-04-27 "GOOG" 108.37000274658203 USD
P 2023-04-28 "GOOG" 108.22000122070312 USD
P 2023-05-01 "GOOG" 107.70999908447266 USD
P 2023-05-02 "GOOG" 105.9800033569336 USD
P 2023-05-03 "GOOG" 106.12000274658203 USD
